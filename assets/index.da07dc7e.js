import{r as e,c as a,o as t,i as n,a as u,n as l,b as o,d as r,e as s,f as c,w as i,u as p,F as d,g as m,h as v,j as f}from"./vendor.0b2d161d.js";v({setup(v){const f=e([]),N=e(1),w=e(10),h=e(""),b=e([]),g=e([]),y=a((()=>g.value.map((e=>({text:e,value:e}))))),x=e([]),U=e([]),P=a((()=>U.value.map((e=>({text:e,value:e}))))),A=e(null);async function k({companies:e,serverName:a,townName:t,updatedAt:n}){const u=[];for(const l of e)for(const e of l.products)u.push({updatedAt:n,serverName:a,townName:t,companyName:l.company_name,productName:e.name,productAmount:e.amount,productUnitPrice:e.unit_price});return u}t((async function(){const e=n.service(),{data:a}=await u.get("data/stats.json");let t=[];g.value=[],U.value=[];for(const n in a){g.value.push(n);const e=a[n];for(const a in e){-1===U.value.indexOf(a)&&U.value.push(a);if(0===e[a])continue;const{data:l}=await u.get(`data/${n}-${a}.json`),{companies:o,updated_at:r}=l;t=t.concat(await k({companies:o,serverName:n,townName:a,updatedAt:r}))}}f.value=t,b.value=g.value,x.value=U.value,l((()=>e.close()))}));const j=a((function(){const e=m.exports.tify(h.value);return f.value.filter((a=>{const t=a.productName.match(e),n=m.exports.sify(a.productName).match(h.value);return!(""!==h.value&&!t&&!n)&&(-1!==b.value.indexOf(a.serverName)&&-1!==x.value.indexOf(a.townName))})).sort(((e,a)=>"ascending"===A.value?e.productUnitPrice-a.productUnitPrice:"descending"===A.value?a.productUnitPrice-e.productUnitPrice:0))})),C=a((function(){return j.value.slice((N.value-1)*w.value,N.value*w.value)}));function _(e,a,t,n){return(new Intl.NumberFormat).format(Number(t))}function z(e){N.value=e}function F({column:e,prop:a,order:t}){"productUnitPrice"===a&&(A.value=t)}function O(e){e.serverName&&(b.value=e.serverName),e.townName&&(x.value=e.townName)}function V(){return!0}return(e,a)=>{const t=o("el-input"),n=o("el-table-column"),u=o("el-table"),l=o("el-pagination");return r(),s(d,null,[c(t,{modelValue:h.value,"onUpdate:modelValue":a[1]||(a[1]=e=>h.value=e),size:"mini",placeholder:"商品關鍵字"},null,8,["modelValue"]),c(u,{"row-key":"date",data:p(C),style:{width:"100%"},onSortChange:F,onFilterChange:O},{default:i((()=>[c(n,{prop:"updatedAt",label:"更新日期",width:"180","column-key":"date"}),c(n,{prop:"serverName",label:"伺服器",width:"180","column-key":"serverName",filters:p(y),"filter-method":V,"filtered-value":b.value},null,8,["filters","filtered-value"]),c(n,{prop:"townName",label:"港口","column-key":"townName",filters:p(P),"filter-method":V,"filtered-value":x.value},null,8,["filters","filtered-value"]),c(n,{prop:"companyName",label:"商會"}),c(n,{prop:"productName",label:"商品"}),c(n,{prop:"productAmount",label:"數量"}),c(n,{prop:"productUnitPrice",sortable:"",label:"價格",formatter:_})])),_:1},8,["data"]),c(l,{background:"",layout:"prev, pager, next",total:p(j).length,"page-size":w.value.value,onCurrentChange:z},null,8,["total","page-size"])],64)}}}).use(f).mount("#app");
