import{r as e,o as a,i as t,a as n,n as o,c as l,b as r,d as u,e as c,f as s,w as i,u as p,F as d,g as m,h as v}from"./vendor.baaec12a.js";m({setup(m){const v=e([]),f=e(1),N=e(10),b=e(""),g=e(["護衛艦(推薦)","探索號(推薦)","幽靈船","戰列艦"]),w=e(null);async function h({companies:e,serverName:a,townName:t,updatedAt:n}){const o=[];for(const l of e)for(const e of l.products)o.push({updatedAt:n,serverName:a,townName:t,companyName:l.company_name,productName:e.name,productAmount:e.amount,productUnitPrice:e.unit_price});return o}a((async function(){const e=t.service(),{data:a}=await n.get("data/stats.json");let l=[];for(const t in a){const e=a[t];for(const a in e){if(0===e[a])continue;const{data:o}=await n.get(`data/${t}-${a}.json`),{companies:r,updated_at:u}=o;l=l.concat(await h({companies:r,serverName:t,townName:a,updatedAt:u}))}}v.value=l,o((()=>{e.close()}))}));const y=l((function(){return v.value.filter((e=>""===b.value||e.productName.match(b.value)?-1!==g.value.indexOf(e.serverName):(console.log(b.value),!1))).sort(((e,a)=>"ascending"===w.value?e.productUnitPrice-a.productUnitPrice:"descending"===w.value?a.productUnitPrice-e.productUnitPrice:0)).slice((f.value-1)*N.value,f.value*N.value)}));function U(e,a,t,n){return(new Intl.NumberFormat).format(Number(t))}function P(e){f.value=e}function x({column:e,prop:a,order:t}){"productUnitPrice"===a&&(w.value=t)}function A(e){g.value=e.serverName}return(e,a)=>{const t=r("el-input"),n=r("el-table-column"),o=r("el-table"),l=r("el-pagination");return u(),c(d,null,[s(t,{modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=e=>b.value=e),size:"mini",placeholder:"商品關鍵字"},null,8,["modelValue"]),s(o,{"row-key":"date",data:p(y),style:{width:"100%"},onSortChange:x,onFilterChange:A},{default:i((()=>[s(n,{prop:"updatedAt",label:"更新日期",width:"180","column-key":"date"}),s(n,{prop:"serverName",label:"伺服器",width:"180","column-key":"serverName",filters:[{text:"護衛艦(推薦)",value:"護衛艦(推薦)"},{text:"探索號(推薦)",value:"探索號(推薦)"},{text:"幽靈船",value:"幽靈船"},{text:"戰列艦",value:"戰列艦"}],"filtered-value":g.value},null,8,["filters","filtered-value"]),s(n,{prop:"townName",label:"港口"}),s(n,{prop:"companyName",label:"商會"}),s(n,{prop:"productName",label:"商品"}),s(n,{prop:"productAmount",label:"數量"}),s(n,{prop:"productUnitPrice",sortable:"",label:"價格",formatter:U})])),_:1},8,["data"]),s(l,{background:"",layout:"prev, pager, next",total:p(y).length,"page-size":N.value,onCurrentChange:P},null,8,["total","page-size"])],64)}}}).use(v).mount("#app");
