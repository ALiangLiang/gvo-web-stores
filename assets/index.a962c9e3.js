import{r as e,c as a,o as t,i as l,a as n,n as u,b as o,d as r,e as s,w as i,f as c,u as d,g as p,h as m,j as v,k as f}from"./vendor.5ccbe469.js";const b=p("大航海時代Online 非官方 商館店鋪檢索器 by 護衛艦-良良"),N=p(" 使用說明： "),g=c("br",null,null,-1),h=p("1. 非即時資料，此工具大概會在半夜三點（+8時區）自動更新資料 "),w=c("br",null,null,-1),y=p("2. 商品關鍵字支援簡體轉繁體中文搜尋 "),x=c("br",null,null,-1),P=p("3. 有 bug 可以"),U=c("a",{href:"https://github.com/ALiangLiang/gvo-web-stores/issues"},"開 issue",-1),_=p(" 回報 "),A=c("br",null,null,-1),k=p("4. 如果有興趣增添功能、修 bug 也歡迎 PR ");v({setup(p){const v=e([]),f=e(1),j=e(10),C=e(""),O=e([]),z=e([]),V=a((()=>z.value.map((e=>({text:e,value:e}))))),F=e([]),L=e([]),$=a((()=>L.value.map((e=>({text:e,value:e}))))),I=e(null);async function R({companies:e,serverName:a,townName:t,updatedAt:l}){const n=[];for(const u of e)for(const e of u.products)n.push({updatedAt:l,serverName:a,townName:t,companyName:u.company_name,productName:e.name,productAmount:e.amount,productUnitPrice:e.unit_price});return n}t((async function(){const e=l.service(),{data:a}=await n.get("data/stats.json");let t=[];z.value=[],L.value=[];for(const l in a){z.value.push(l);const e=a[l];for(const a in e){-1===L.value.indexOf(a)&&L.value.push(a);if(0===e[a])continue;const{data:u}=await n.get(`data/${l}-${a}.json`),{companies:o,updated_at:r}=u;t=t.concat(await R({companies:o,serverName:l,townName:a,updatedAt:r}))}}v.value=t,O.value=z.value,F.value=L.value,u((()=>e.close()))}));const S=a((function(){const e=m.exports.tify(C.value);return v.value.filter((a=>{const t=a.productName.match(e),l=m.exports.sify(a.productName).match(C.value);return!(""!==C.value&&!t&&!l)&&(-1!==O.value.indexOf(a.serverName)&&-1!==F.value.indexOf(a.townName))})).sort(((e,a)=>"ascending"===I.value?e.productUnitPrice-a.productUnitPrice:"descending"===I.value?a.productUnitPrice-e.productUnitPrice:0))})),q=a((function(){return S.value.slice((f.value-1)*j.value,f.value*j.value)}));function B(e,a,t,l){return(new Intl.NumberFormat).format(Number(t))}function D(e){f.value=e}function E({column:e,prop:a,order:t}){"productUnitPrice"===a&&(I.value=t)}function G(e){e.serverName&&(O.value=e.serverName),e.townName&&(F.value=e.townName)}function H(){return!0}return(e,a)=>{const t=o("el-header"),l=o("el-input"),n=o("el-table-column"),u=o("el-table"),p=o("el-pagination"),m=o("el-main"),v=o("el-footer"),f=o("el-container");return r(),s(f,null,{default:i((()=>[c(t,null,{default:i((()=>[b])),_:1}),c(m,null,{default:i((()=>[c(l,{modelValue:C.value,"onUpdate:modelValue":a[1]||(a[1]=e=>C.value=e),size:"mini",placeholder:"商品關鍵字"},null,8,["modelValue"]),c(u,{"row-key":"date",data:d(q),style:{width:"100%"},onSortChange:E,onFilterChange:G},{default:i((()=>[c(n,{prop:"updatedAt",label:"更新日期",width:"180","column-key":"date"}),c(n,{prop:"serverName",label:"伺服器",width:"180","column-key":"serverName",filters:d(V),"filter-method":H,"filtered-value":O.value},null,8,["filters","filtered-value"]),c(n,{prop:"townName",label:"港口","column-key":"townName",filters:d($),"filter-method":H,"filtered-value":F.value},null,8,["filters","filtered-value"]),c(n,{prop:"companyName",label:"商會"}),c(n,{prop:"productName",label:"商品"}),c(n,{prop:"productAmount",label:"數量"}),c(n,{prop:"productUnitPrice",sortable:"",label:"價格",formatter:B})])),_:1},8,["data"]),c(p,{background:"",layout:"prev, pager, next",total:d(S).length,"page-size":j.value.value,onCurrentChange:D},null,8,["total","page-size"])])),_:1}),c(v,null,{default:i((()=>[N,g,h,w,y,x,P,U,_,A,k])),_:1})])),_:1})}}}).use(f).mount("#app");
