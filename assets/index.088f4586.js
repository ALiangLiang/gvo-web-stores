import{r as e,c as a,o as t,i as l,a as n,n as o,b as u,d as r,e as c,f as s,w as i,u as p,F as d,g as m,h as v}from"./vendor.baaec12a.js";m({setup(m){const v=e([]),f=e(1),N=e(10),b=e(""),g=e([]),h=a((()=>g.value.map((e=>({text:e,value:e}))))),w=e([]),y=a((()=>w.value.map((e=>({text:e,value:e}))))),U=e(null);async function P({companies:e,serverName:a,townName:t,updatedAt:l}){const n=[];for(const o of e)for(const e of o.products)n.push({updatedAt:l,serverName:a,townName:t,companyName:o.company_name,productName:e.name,productAmount:e.amount,productUnitPrice:e.unit_price});return n}t((async function(){const e=l.service(),{data:a}=await n.get("data/stats.json");let t=[];g.value=[],w.value=[];for(const l in a){g.value.push(l);const e=a[l];for(const a in e){-1===w.value.indexOf(a)&&w.value.push(a);if(0===e[a])continue;const{data:o}=await n.get(`data/${l}-${a}.json`),{companies:u,updated_at:r}=o;t=t.concat(await P({companies:u,serverName:l,townName:a,updatedAt:r}))}}v.value=t,o((()=>{e.close()}))}));const A=a((function(){return v.value.filter((e=>""===b.value||e.productName.match(b.value)?-1!==g.value.indexOf(e.serverName):(console.log(b.value),!1))).sort(((e,a)=>"ascending"===U.value?e.productUnitPrice-a.productUnitPrice:"descending"===U.value?a.productUnitPrice-e.productUnitPrice:0)).slice((f.value-1)*N.value,f.value*N.value)}));function x(e,a,t,l){return(new Intl.NumberFormat).format(Number(t))}function k(e){f.value=e}function C({column:e,prop:a,order:t}){"productUnitPrice"===a&&(U.value=t)}function _(e){g.value=e.serverName}return(e,a)=>{const t=u("el-input"),l=u("el-table-column"),n=u("el-table"),o=u("el-pagination");return r(),c(d,null,[s(t,{modelValue:b.value,"onUpdate:modelValue":a[1]||(a[1]=e=>b.value=e),size:"mini",placeholder:"商品關鍵字"},null,8,["modelValue"]),s(n,{"row-key":"date",data:p(A),style:{width:"100%"},onSortChange:C,onFilterChange:_},{default:i((()=>[s(l,{prop:"updatedAt",label:"更新日期",width:"180","column-key":"date"}),s(l,{prop:"serverName",label:"伺服器",width:"180","column-key":"serverName",filters:p(h),"filtered-value":g.value},null,8,["filters","filtered-value"]),s(l,{prop:"townName",label:"港口",filters:p(y),"filtered-value":w.value},null,8,["filters","filtered-value"]),s(l,{prop:"companyName",label:"商會"}),s(l,{prop:"productName",label:"商品"}),s(l,{prop:"productAmount",label:"數量"}),s(l,{prop:"productUnitPrice",sortable:"",label:"價格",formatter:x})])),_:1},8,["data"]),s(o,{background:"",layout:"prev, pager, next",total:p(A).length,"page-size":N.value,onCurrentChange:k},null,8,["total","page-size"])],64)}}}).use(v).mount("#app");
